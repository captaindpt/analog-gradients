* MIM Memristor â€” SDevice Physics Deck (Phase 1: Baseline)
* No traps, no defect drift. Baseline includes direct barrier tunneling paths.
* Substitute: %%SWEEP_VMAX%%

File {
  Grid    = "memdev_msh.tdr"
  Plot    = "memdev"
  Current = "memdev"
  Output  = "memdev"
  Parameter = "hfo2.par"
}

Electrode {
  { Name="top"    Voltage=0.0 Material="Aluminum" }
  { Name="bottom" Voltage=0.0 Material="Aluminum" }
}

Physics {
  DefaultParametersFromFile
  Fermi
  Mobility( DopingDep HighFieldSaturation Enormal )
  Recombination( SRH )
  eBarrierTunneling "NLM_TOP"
  hBarrierTunneling "NLM_TOP"
  eBarrierTunneling "NLM_BOT"
  hBarrierTunneling "NLM_BOT"
}

* Note: HfO2 is an insulator. Non-local tunneling paths provide baseline current.

Plot {
  eDensity hDensity eCurrent hCurrent
  ElectricField Potential SpaceCharge
  Doping DonorConcentration AcceptorConcentration
  eBarrierTunneling hBarrierTunneling
  NonLocal
  TotalCurrent
}

Math {
  NonLocal "NLM_TOP" (
    Electrode = "top"
    Length = 2e-6
    Digits = 4
    EnergyResolution = 1e-4
  )
  NonLocal "NLM_BOT" (
    Electrode = "bottom"
    Length = 2e-6
    Digits = 4
    EnergyResolution = 1e-4
  )
  Extrapolate
  RelErrControl
  Notdamped=50
  Iterations=30
  Method=Blocked
  SubMethod=ParDiSo
}

Solve {
  * Initial equilibrium
  Coupled(Iterations=100){ Poisson }
  Coupled(Iterations=100){ Poisson Electron Hole }

  * DC sweep: 0 -> +%%SWEEP_VMAX%% V on top electrode
  Quasistationary(
    InitialStep=0.01
    Increment=1.5
    MinStep=1e-6
    MaxStep=0.05
    Goal{ Name="top" Voltage=%%SWEEP_VMAX%% }
  ) {
    Coupled { Poisson Electron Hole }
  }
}
